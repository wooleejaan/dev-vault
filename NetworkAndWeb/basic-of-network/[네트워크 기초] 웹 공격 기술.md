# 웹 공격 기술

http 프로토콜 자체는 보안 상 문제가 발생할 정도로 복잡한 프로토콜이 아니므로 공격대상x => 주로 공격대상은 http를 사용하는 서버, 클라이언트, 그리고 서버 상 동작하는 웹 어플리케이션의 리소스.

원격 접속으로 사용하는 SSH 프로토콜은 프로토콜 레벨에서 인증, 세션 관리 등 기능이 준비되어 있지만 => HTTP에는 없음. 그러므로 인증/세션관리를 개발자가 설계하고 구현해야 함.

request는 클라이언트에서 변조 가능 => http request 메시지에 공격 코드를 실어 실행 가능 (query, form, http header, cookie 등 경유해서 보내질 때 취약성이 발생할 수 있음)

### 웹 애플리케이션에 대한 공격 패턴은 2가지

1. 능동적 공격

서버를 노리는 능동적 공격. => 공격자가 직접 웹 어플리케이션에 접근해서 공격 코드 보냄. (서버 상 리소스에 접근해서 직접 실행)

- SQL 인젝션, OS 커맨드 인젝션 등 ...

2. 수동적 공격

유저에게 공격 코드를 실행시키는 공격.

- XSS(cross-site scripting), CSRF(cross site request forgery) 등 ...

수동적인 공격을 하면, 인트라넷처럼 인터넷에서 직접 접근할 수 없는 네트워크를 공격할 수도 있음.

### 웹 어플리케이션의 보안 대책 실시 장소

1. 클라이언트에서 체크

클라이언트 측 체크는 보통 js를 사용. => 변조 혹은 무효화될 수 있으므로 근본적인 해결책x.

2. 웹 어플리케이션(서버)에서 체크 (입력값 체크, 출력값 체크)

#### XSS

취약성 있는 웹 방문한 사용자의 브라우저에 부정한 html 태그나 js 등을 동작시키는 공격. (동적으로 html 생성하는 부분에서 취약성 존재)

- 가짜 입력 form 작성 유도
- 스크립트로 유저 쿠키 값 탈취, 유저가 의도하지 않은 request 송신
- 가짜 문장이나 이미지 표시

#### SQL 인젝션

db에 부정한 sql을 실행하는 공격.

- db 내 데이터 부정 열람이나 변조
- 인증 회피
- db 서버를 경유한 프로그램 실행 등

sql 인젝션은 공격자에 의해 개발자가 의도하지 않은 형태로 sql 문장이 변경되어 구조 파괴되는 공격.

#### OS 커맨드 인젝션

os 커맨드 인젝션(OS Command Injection)은 웹 어플리케이션 경유해서 OS 명령 부정하게 실행하는 공격. (주로 shell 호출 함수 있는 곳에서 발생)

#### HTTP 헤더 인젝션

HTTP Header Injection이란 공격자가 response 헤더 필드에 개행 문자 등을 삽입해서 임의의 response 헤더 필드나 바디를 추가하는 수동적인 공격.

- 임의의 쿠키 세트
- 임의의 URL에 redirect
- 임의의 body 표시 (HTTP Response Splitting Attack)

특히 바디를 추가하는 공격은 HTTP response 분할 공격(HTTP Response Splitting Attack)이라고 부름.

http/1.1의 복수 response를 모아서 돌려보내는 기능을 악용해서 캐시 서버 등에 임의의 콘텐츠를 캐시하기도 함. (캐시 오염)

#### 메일 헤더 인젝션

Mail Header Injection

웹 어플리케이션 메일 송신 기능에 공격자가 임의의 To 및 Subject 등 메일 헤더를 부정하게 추가하는 공격.

#### 디렉토리 접근 공격

Directory Traversal 비공개 디렉토리 파일에 대해 부정하게 디렉토리 path를 가로질러 접근하는 공격. (Path Traversal)

#### Remote File Inclusion

스크립트 일부를 다른 파일에서 읽어올 때 공격자가 지정한 외부 서버의 RUL을 파일에서 읽게 함으로써 임의의 스크립트 동작시키는 공격.

## 웹 서버 설정이나 설계 미비로 인한 취약성

웹 서버 설정 혹은 설계 실수

### 강제 브라우징 (Forced Browsing)

웹 서버 공개 디렉토리에 있는 파일 중에서 공개 의도가 없는 파일이 열람되게 하는 취약성<br>
=> 문제점

- 고객 정보 등 중요 정보 누설
- 본래 엑세스 권한이 있는 사용자에게만 표시하지 않는 정보 누설
- 어디에서도 링크되지 않은 파일 누설

공개하고 싶지 않은 파일 url을 숨기는 정도의 보안 대책 => 해당 url만 알면 파일 열람할 수 있으므로 취약

### 부적절한 에러 메시지 처리 Error Handling Vulnerability

공격자에게 유익한 정보가 웹 어플리케이션 에러 메시지에 포함되는 취약성

### Open Redirect

지정한 임의의 URL로 redirect 기능. => url이 악성 웹이면 취약

## 세션 관리 미비로 인한 취약성

### 세션 하이잭 Session Hijack

어떤 방법으로 유저 세션id를 입수해 악용, 유저로 위장하는 공격.

공격자가 세션id 입수 방법

- 부적절한 생성 방법에 의한 세션id 추측
- 도청이나 XSS 등에 의한 세션 id 도용
- 세션 고정 공격에 의한 세션 id 강제

### 세션 픽세이션 Session Fixation

공격자가 지정한 세션id를 유저에게 강제로 사용하도록 하는 수동적 공격. (세션 고정 공격)

### 세션 어댑션 Session Adoption

PHP나 ASP.NET 등에 존재하는 미지의 세션 id를 받아들이는 기능. => 이 기능 악용 시, Session Fixation의 준비 단계에 필요했던 웹사이트에서 세션id를 발행받는 수고를 생략할 수 있음. (미들웨어에서 공격자가 임의로 만든 세션id를 주입)

### CSRF, Cross-Site Request Forgeries

인증된 유저가 의도하지 않는 개인정보나 설정정보 등을 공격자가 설치해 둔 함정에 의해 어떤 상태를 갱신하는 처리를 강제로 실행하는 공격. (수동적 공격)

- 인증된 유저의 권한으로 설정 정보 등을 갱신
- 인증된 유저의 권한으로 상품을 구입
- 인증된 유저의 권한으로 게시판에 글 작성

## 기타 공격

### 패스워드 크래킹 Password Cracking

패스워드를 논리적으로 이끌어내서 인증 돌파하는 공격.

- 네트워크 경유로 패스워드 시행
- 암호화된 패스워드를 해독(공격자가 시스템에 침입하는 방법 등을 통해, 암호화나 해시화된 패스워드의 데이터를 취득한 상황)

#### 네트워크 경유로 패스워드 시행

- 무차별 대입 공격 Brute-force Attact

모든 키의 집합 키 공간(keyspace), 즉 모든 패스워드 후보를 시험해서 인증 돌파 공격 => 키 공간이 크면 해독하기 어려움

- 사전 공격 Dictionary Attack

사전에 패스워드 후보 준비해두고 시험해서 인증 돌파 공격.

### 클릭 재킹 Clickjacking

투명한 버튼이나 링크를 함정으로 사용할 웹 페이지에 심어두고 클릭하게 끔 하는 공격 (UI Redressing)

### Dos 공격

Denial of Service attack => 서비스 제공을 정지 상태로 만드는 공격. (서비스 정지 공격 or 서비스 거부 공격)

- 엑세스를 집중시킴으로써 부하를 걸어 리소스를 다 소비하게 해 사실상 서비스 정지 상태로 만듦
- 취약성을 공격해 서비스 정지시킴

여러 대 컴퓨터에서 실행하는 DoS 공격을 DDoS 공격(Distributed Denial of Service attack)이라 함

### 백도어 공격 Backdoor

제한된 기능을 정규 절차를 밟지 않고 이용하기 위해 설치된 뒷문.

- 개발 단계에 디버그용으로 추가한 백도어
- 개발자가 자기 자신의 이익을 위해서 추가한 백도어
- 공격자가 어떠한 방법을 써서 설치한 백도어
